Sync with pwsh or see git history for old working
